<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proceso de Compra</title>
    <link rel="stylesheet" href="../css/carrito.css">
</head>
<body>
    <header class="main-header">
        <div class="header-container">
            <h1>LUXE STYLE</h1>
        </div>
    </header>

    <div class="container">
        <div class="pasos-indicador">
            <div class="paso-indicador" data-paso="1">
                <div class="paso-circulo">1</div>
                <span class="paso-label">Carrito</span>
            </div>
            <div class="paso-linea"></div>
            <div class="paso-indicador" data-paso="2">
                <div class="paso-circulo">2</div>
                <span class="paso-label">Datos</span>
            </div>
            <div class="paso-linea"></div>
            <div class="paso-indicador" data-paso="3">
                <div class="paso-circulo">3</div>
                <span class="paso-label">Pago</span>
            </div>
            <div class="paso-linea"></div>
            <div class="paso-indicador" data-paso="4">
                <div class="paso-circulo">4</div>
                <span class="paso-label">Compra realizado</span>
            </div>
        </div>

        <!-- Paso 1: Carrito -->
        <div id="paso-carrito" class="paso-checkout">
            <h2>Tu Carrito</h2>
            
            <div class="carrito-layout">
                <!-- Columna izquierda: Productos -->
                <div class="carrito-productos">
                    <div class="carrito-items-container"></div>
                    <div class="carrito-centro-botones">
                        <button class="btn btn-secondary" id="seguir-comprando">Seguir Comprando</button>
                    </div>
                </div>
                
                <!-- Columna derecha: Resumen y botones -->
                <div class="carrito-resumen">
                    <div class="plan" aria-label="Resumen del pedido">
                        <div class="inner">
                            <p class="title">Resumen del pedido</p>
                            <p class="info">Revisa los detalles antes de continuar con tu compra.</p>
                            <ul class="features">
                                <li>
                                    <span class="icon">
                                        <svg height="24" width="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path></svg>
                                    </span>
                                    <span>Subtotal: <strong>S/ <span id="subtotal-carrito">0.00</span></strong></span>
                                </li>
                                <li>
                                    <span class="icon">
                                        <svg height="24" width="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path></svg>
                                    </span>
                                    <span>IGV (18%): <strong>S/ <span id="igv-carrito">0.00</span></strong></span>
                                </li>
                                <li>
                                    <span class="icon">
                                        <svg height="24" width="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path fill="currentColor" d="M10 15.172l9.192-9.193 1.415 1.414L10 18l-6.364-6.364 1.414-1.414z"></path></svg>
                                    </span>
                                    <span><strong>Total: S/ <span id="total-carrito">0.00</span></strong></span>
                                </li>
                            </ul>
                            <p id="mensaje-delivery" style="color:#888; font-size:0.95em; margin-top:8px; display:none;">
                                Entrega en 1 a 7 días hábiles. Si no llega en ese plazo, se le devolverá su dinero.
                            </p>
                            <div class="action">
                                <button class="plan button btn-block btn-primary" id="siguiente-envio">Proceder al pago</button>
                            </div>
                            <div class="action" style="margin-top:10px;">
                                <button class="plan button btn-danger" id="vaciar-carrito">Vaciar Carrito</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Paso 2: Envío -->
        <div id="paso-envio" class="paso-checkout hidden">
            <h2>Información de Contacto y Entrega</h2>
            
            <!-- Información de Contacto -->
            <div class="seccion-contacto">
                <h3>Información de Contacto</h3>
                <div class="input-container">
                    <input class="input" name="nombre-cliente" id="nombre-cliente" type="text" required placeholder="Ejemplo: Juan Pérez">
                    <label class="label" for="nombre-cliente">Nombre Completo</label>
                    <div class="topline"></div>
                    <div class="underline"></div>
                    <small class="ayuda-input">Ingresa tu nombre y apellido tal como figura en tu documento.</small>
                </div>
                <div class="input-container">
                    <input class="input" name="dni-cliente" id="dni-cliente" type="text" required maxlength="8" placeholder="Ejemplo: 12345678">
                    <label class="label" for="dni-cliente">DNI</label>
                    <div class="topline"></div>
                    <div class="underline"></div>
                    <small class="ayuda-input">Debe tener 8 dígitos, solo números.</small>
                </div>
                <div class="input-container">
                    <input class="input" name="email" id="email" type="email" required placeholder="Ejemplo: correo@dominio.com">
                    <label class="label" for="email">Correo Electrónico</label>
                    <div class="topline"></div>
                    <div class="underline"></div>
                    <small class="ayuda-input">Te enviaremos la confirmación de tu pedido a este correo.</small>
                </div>
                <div class="input-container">
                    <input class="input" name="telefono" id="telefono" type="tel" required placeholder="Ejemplo: 999999999">
                    <label class="label" for="telefono">Número de Teléfono</label>
                    <div class="topline"></div>
                    <div class="underline"></div>
                    <small class="ayuda-input">Solo números, 9 dígitos.</small>
                </div>
            </div>

            <div class="metodo-entrega-container">
                <!-- Opción Delivery -->
                <label class="opcion-entrega-card">
                    <input type="radio" name="metodo-entrega" id="delivery" value="delivery" checked>
                    <div class="opcion-card-contenido">
                        <div class="opcion-card-titulo">Delivery a Domicilio</div>
                        <div class="opcion-card-descripcion">
                            Recibe tu pedido en la puerta de tu casa. Costo adicional S/ 5.00.
                        </div>
                        <div class="opcion-card-footer">
                            <svg class="opcion-card-icono" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" fill="none">
                                <path d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z"
                                    stroke-linejoin="round" stroke-linecap="round"></path>
                            </svg>
                            <span class="opcion-card-label">Seleccionar</span>
                        </div>
                    </div>
                </label>
                <!-- Opción Recojo en Tienda -->
                <label class="opcion-entrega-card">
                    <input type="radio" name="metodo-entrega" id="recojo" value="recojo">
                    <div class="opcion-card-contenido">
                        <div class="opcion-card-titulo">Recojo en Tienda</div>
                        <div class="opcion-card-descripcion">
                            Retira tu pedido en cualquiera de nuestras tiendas sin costo adicional.
                        </div>
                        <div class="opcion-card-footer">
                            <svg class="opcion-card-icono" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" fill="none">
                                <path d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z"
                                    stroke-linejoin="round" stroke-linecap="round"></path>
                            </svg>
                            <span class="opcion-card-label">Seleccionar</span>
                        </div>
                    </div>
                </label>
            </div>

            <!-- Formulario para Delivery -->
            <div id="formulario-delivery" class="formulario-entrega">
                <h4>Mis direcciones</h4>
                
                <div class="direcciones-container" style="display: flex; gap: 24px; align-items: flex-start;">
                    <!-- Columna izquierda: direcciones -->
                    <div style="flex: 1;">
                        <div class="direcciones-grid" id="direcciones-grid">
                            <!-- Aquí se cargarán dinámicamente las tarjetas de direcciones -->
                        </div>
                        <!-- Tarjeta para agregar nueva dirección -->
                        <div class="address-card-container" id="nueva-direccion-card">
                            <div class="canvas">
                                <div class="tracker"></div>
                                <div id="card" class="add-card">
                                    <div class="card-content">
                                        <div class="card-glare"></div>
                                        <div class="cyber-lines">
                                            <span></span><span></span><span></span><span></span>
                                        </div>
                                        <p id="prompt"><i class="fas fa-plus"></i> AGREGAR DIRECCIÓN</p>
                                        <div class="corner-elements">
                                            <span></span><span></span><span></span><span></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Columna derecha: tarjeta de nota delivery -->
                    <div style="flex: 0 0 340px; max-width: 340px;">
                        <div class="anuncio-delivery" id="card-nota-delivery">
                            <div class="anuncio-icono">
                                <span>🚚</span>
                            </div>
                            <div class="anuncio-textos">
                                <div class="anuncio-titulo">¡Atención!</div>
                                <div class="anuncio-mensaje">
                                    El <b>delivery</b> tiene un <b>costo adicional de S/ 5.00</b>.<br>
                                    Entrega en <b>1 a 7 días hábiles</b>.<br>
                                    Si no llega en ese plazo, se le devolverá su dinero.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Formulario oculto para agregar dirección nueva -->
                <div id="nueva-direccion-form" class="hidden">
                    <h4>Agregar nueva dirección</h4>
                    <div class="form-group">
                        <label for="etiqueta-direccion">Nombre de la dirección</label>
                        <input type="text" id="etiqueta-direccion" placeholder="Casa, Trabajo, etc.">
                    </div>
                    <div class="form-group">
                        <label for="direccion-nueva">Dirección</label>
                        <input type="text" id="direccion-nueva" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ciudad-nueva">Ciudad</label>
                            <input type="text" id="ciudad-nueva" required>
                        </div>
                        <div class="form-group">
                            <label for="codigo-postal-nuevo">Código Postal</label>
                            <input type="text" id="codigo-postal-nuevo" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="referencias">Referencias (opcional)</label>
                        <textarea id="referencias" placeholder="Indicaciones adicionales..."></textarea>
                    </div>
                    <div class="form-buttons">
                        <button type="button" class="btn btn-secondary" id="cancelar-direccion">Cancelar</button>
                        <button type="button" class="btn btn-primary" id="guardar-direccion">Guardar</button>
                    </div>
                </div>
                
                <!-- Formulario para la dirección seleccionada -->
                <div id="direccion-seleccionada-form">
                    <div class="form-group">
                        <label for="direccion">Dirección</label>
                        <input type="text" id="direccion" required>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="ciudad">Ciudad</label>
                            <input type="text" id="ciudad" required>
                        </div>
                        <div class="form-group">
                            <label for="codigo-postal">Código Postal</label>
                            <input type="text" id="codigo-postal" required>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Formulario para Recojo en Tienda -->
            <div id="formulario-recojo" class="formulario-entrega hidden">
                <div class="form-group">
                    <label for="tienda">Selecciona la Tienda</label>
                    <select id="tienda" required>
                        <option value="">Selecciona una tienda</option>
                        <option value="tienda1">Tienda Central</option>
                        <option value="tienda2">Tienda Norte</option>
                        <option value="tienda3">Tienda Sur</option>
                    </select>
                </div>
            </div>

            <div class="paso-navegacion">
                <button class="btn btn-secondary" id="volver-carrito">Anterior</button>
                <button class="btn btn-primary" id="siguiente-pago">Siguiente</button>
            </div>
        </div>

        <!-- Paso 3: Pago -->
        <div id="paso-pago" class="paso-checkout hidden">
            <h2>Información de Pago</h2>
            
            <div class="metodo-pago-moderno">
                <form class="form-pago">
                    <!-- Radios ocultos para método de pago -->
                    <input type="radio" name="metodo-pago" value="tarjeta" id="radio-tarjeta" checked style="display:none;">
                    <input type="radio" name="metodo-pago" value="yape" id="radio-yape" style="display:none;">
                    <input type="radio" name="metodo-pago" value="paypal" id="radio-paypal" style="display:none;">
                    <div class="payment-options">
                        <button type="button" id="btn-tarjeta" class="payment-option active">
                            <img id="logo-tarjeta" src="https://cdn-icons-png.flaticon.com/512/633/633611.png" alt="Tarjeta de Crédito" style="height:32px;">
                        </button>
                        <button type="button" id="btn-yape" class="payment-option">
                            <span class="text" style="font-size: 1.1em; color: #ff0000;">Pago por QR</span>
                        </button>
                        <button type="button" id="btn-paypal" class="payment-option">
                            <img src="https://www.paypalobjects.com/webstatic/icon/pp258.png" alt="PayPal" style="height:24px; margin-right:10px;">
                        </button>
                    </div>
                    
                    <div class="separator">
                        <hr class="line">
                        <p id="separator-text">pagar con tarjeta de crédito</p>
                        <hr class="line">
                    </div>
                    
                    <!-- Contenedor de tarjeta de crédito -->
                    <div id="tarjeta-container" class="credit-card-info">
                        <div class="input-container">
                            <label for="nombre-tarjeta" class="input-label">Nombre completo del titular</label>
                            <input id="nombre-tarjeta" class="input-field" type="text" placeholder="Ingrese el nombre como aparece en la tarjeta">
                        </div>
                        <div class="input-container" style="position:relative;">
                            <label for="numero-tarjeta" class="input-label">Número de Tarjeta</label>
                            <input id="numero-tarjeta" class="input-field" type="text" placeholder="1234 5678 9012 3456" autocomplete="cc-number">
                            <img id="logo-tipo-tarjeta" src="" alt="" style="height:28px;position:absolute;right:10px;top:35px;display:none;">
                            <div id="tipo-tarjeta" class="mt-2"></div>
                        </div>
                        <div class="input-container">
                            <label class="input-label">Fecha de Vencimiento / CVV</label>
                            <div class="split">
                                <input id="fecha-vencimiento" class="input-field" type="text" placeholder="MM/AA" maxlength="5">
                                <input id="cvv" class="input-field" type="number" placeholder="CVV" maxlength="4">
                            </div>
                        </div>
                    </div>
                    
                    <!-- Paso 1: Ingreso de correo -->
                    <div id="yape-contenedor" style="display: flex; justify-content: center; gap: 32px; align-items: flex-start;">
                        <!-- Columna izquierda: pasos de Yape -->
                        <div style="flex: 1; min-width: 340px;">
                            <!-- Paso 1 -->
                            <div id="yape-paso-1" style="max-width: 420px; margin: 0 auto;">
                                <label for="yape-email" style="font-size: 1.1em;">
                                    Ingresa tu <b>correo electrónico</b> y genera tu código QR
                                </label>
                                <div style="position: relative; margin-bottom: 8px;">
                                    <input type="email" id="yape-email" placeholder="Correo electrónico" style="width: 100%; padding: 10px; font-size: 1em; margin-top: 8px; border-radius: 5px; border: 1px solid #ccc;">
                                    <div id="yape-email-error" style="display: none; position: absolute; left: 0; top: 48px; background: #fff0f0; color: #c00; border: 1px solid #f99; border-radius: 6px; padding: 4px 10px; font-size: 0.98em; z-index: 2;">
                                        Ingrese un correo válido.
                                        <span style="position: absolute; left: 20px; top: -10px; width: 0; height: 0; border-left: 8px solid transparent; border-right: 8px solid transparent; border-bottom: 10px solid #f99;"></span>
                                    </div>
                                </div>
                                <div style="font-size: 2em; font-weight: bold; margin: 18px 0 8px 0;">
                                    S/ <span id="yape-monto-paso1"></span>
                                </div>
                                <div id="yape-expira-paso1" style="font-size: 1em; color: #222; margin-bottom: 18px;"></div>
                                <div style="margin: 10px 0;">
                                    <input type="checkbox" id="yape-terminos" style="vertical-align: middle;">
                                    <label for="yape-terminos" style="font-size: 0.98em;">
                                        Acepto <a href="#" style="color:#c00;">Términos y Condiciones</a> y <a href="#" style="color:#c00;">Políticas de Privacidad</a>.
                                    </label>
                                </div>
                                <button id="yape-generar-qr" type="button" class="btn-principal" style="width: 100%; font-size: 1.1em; padding: 12px 0; border-radius: 8px; background: #8ca6c7; color: #fff; border: none; margin-top: 10px; opacity: 0.7; cursor: not-allowed;" disabled>
                                    <span style="display: inline-flex; align-items: center;">
                                        <svg style="margin-right: 8px;" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M2 2h2v2H2V2zm3 0h2v2H5V2zm3 0h2v2H8V2zm3 0h2v2h-2V2zM2 5h2v2H2V5zm3 0h2v2H5V5zm3 0h2v2H8V5zm3 0h2v2h-2V5zM2 8h2v2H2V8zm3 0h2v2H5V8zm3 0h2v2H8V8zm3 0h2v2h-2V8zM2 11h2v2H2v-2zm3 0h2v2H5v-2zm3 0h2v2H8v-2zm3 0h2v2h-2v-2z"/></svg>
                                        Generar código QR
                                    </span>
                                </button>
                            </div>
                            <!-- Paso 2 -->
                            <div id="yape-paso-2" style="display: none;">
                                <div style="background: #fff; padding: 24px 32px; border-radius: 8px; box-shadow: 0 2px 8px #0001; min-width: 340px; text-align: center; margin: 0 auto;">
                                    <div style="font-size: 1.15em; margin-bottom: 10px;">
                                        Escanea el QR y <b>págalo desde<br>tu billetera favorita</b>
                                    </div>
                                    <img id="yape-qr-img" src="/img/yape-qr.png" alt="QR Yape" style="width: 200px; height: 200px; margin: 10px 0; border: 2px solid #222; background: #fff;">
                                    <div style="font-size: 2em; font-weight: bold; margin: 18px 0 8px 0;">
                                        S/ <span id="yape-monto-paso2"></span>
                                    </div>
                                    <div id="yape-expira-paso2" style="font-size: 1em; color: #222; margin-bottom: 18px;"></div>
                                    <div style="margin: 10px 0; color: #888; font-size: 1em;">
                                        <span id="yape-email-mostrado"></span>
                                    </div>
                                    <div style="margin: 16px 0 0 0; text-align: left;">
                                        <input type="checkbox" id="yape-terminos-2" checked disabled style="vertical-align: middle;">
                                        <label for="yape-terminos-2" style="font-size: 0.98em;">
                                            Acepto <a href="#" style="color:#c00;">Términos y Condiciones</a> y <a href="#" style="color:#c00;">Políticas de Privacidad</a>.
                                        </label>
                                    </div>
                                </div>
                                <div style="margin-top: 30px; text-align: center;">
                                    <b id="yape-estado-pago">Esperando confirmación de pago...</b>
                                    <div id="yape-loader" style="margin: 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 90px;">
                                        <div class="spinner" style="margin-bottom: 10px;"></div>
                                        <div style="font-size: 1.1em; color: #425275; text-align: center;">Confirmando pago...</div>
                                    </div>
                                    <div id="yape-exito" style="display:none; margin-top: 18px;">
                                        <span style="color: #28a745; font-size: 1.3em; font-weight: bold;">
                                            <svg width="28" height="28" fill="#28a745" viewBox="0 0 16 16" style="vertical-align: middle; margin-right: 6px;">
                                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM7 11.414l5.707-5.707-1.414-1.414L7 8.586 4.707 6.293 3.293 7.707 7 11.414z"/>
                                            </svg>
                                            ¡Pago exitoso!
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Columna derecha: información estática -->
                        <div style="background: #f7f7f7; padding: 24px 32px; border-radius: 8px; min-width: 340px; max-width: 400px;">
                            <div style="font-size: 1.2em; font-weight: bold; margin-bottom: 8px;">Pago por Billeteras Digitales</div>
                            <div style="color: #888; font-size: 1em; margin-bottom: 8px;">
                                Yape, Plin, BBVA Wallet, Scotiabank, Interbank, Ligo, BanBif y Tunki
                            </div>
                            <ol style="font-size: 1em; color: #222; margin-bottom: 12px; padding-left: 18px;">
                                <li>Escoge la billetera de tu preferencia.</li>
                                <li>Escanea el QR desde tu celular.</li>
                                <li>Verifica el monto a pagar a nombre de PagoEfectivo.</li>
                                <li>Confirma el pago.</li>
                            </ol>
                            <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 10px;">
                                <img src="/img/yape.png" alt="Yape" style="height: 38px;">
                                <img src="/img/plin.png" alt="Plin" style="height: 38px;">
                                <img src="/img/bbvawallet.png" alt="BBVA" style="height: 38px;">
                                <img src="/img/scotibank.png" alt="Scotiabank" style="height: 38px;">
                                <img src="/img/interbank.png" alt="Interbank" style="height: 38px;">
                                <img src="/img/ligo.png" alt="Ligo" style="height: 38px;">
                                <img src="/img/banbif.png" alt="BanBif" style="height: 38px;">
                                <img src="/img/tinki.png" alt="Tunki" style="height: 38px;">
                            </div>
                            <div style="font-size: 0.95em; color: #888; margin-top: 8px;">
                                Recuerda habilitar tu tarjeta para compras por internet
                            </div>
                        </div>
                    </div>
                    
                    <!-- Contenedor de PayPal -->
                    <div id="paypal-container">
                        <div class="paypal-info">
                            <p>Serás redirigido a PayPal para completar el pago de forma segura</p>
                        </div>
                        <div class="input-container">
                            <label for="email-paypal" class="input-label">Email de PayPal (obligatorio)</label>
                            <input id="email-paypal" class="input-field" type="email" placeholder="tu@email.com">
                        </div>
                        <div style="display: flex; justify-content: center;">
                            <button type="button" id="btn-pagar-paypal" class="button paypal-btn" style="margin-top:10px;">
                                <img src="https://www.paypalobjects.com/webstatic/icon/pp258.png" alt="PayPal" style="height:24px; margin-right:10px;">
                                <span class="text">Pagar con PayPal</span>
                            </button>
                        </div>
                    </div>
                    
                    <div id="yape-extra-info" style="display:none;">
                        <div id="yape-fecha-limite" style="margin-top:14px; color:#333; font-size:1.05em; text-align:center;">
                            <!-- Aquí se mostrará la fecha límite -->
                        </div>
                    </div>
                    
                    <button type="button" id="confirmar-pedido" class="button" disabled>
                        <span class="icono-flecha">
                            <svg viewBox="0 0 16 16" class="bi bi-cart-check" height="24" width="24" xmlns="http://www.w3.org/2000/svg" fill="#fff">
                                <path d="M11.354 6.354a.5.5 0 0 0-.708-.708L8 8.293 6.854 7.146a.5.5 0 1 0-.708.708l1.5 1.5a.5.5 0 0 0 .708 0l3-3z"></path>
                                <path d="M.5 1a.5.5 0 0 0 0 1h1.11l.401 1.607 1.498 7.985A.5.5 0 0 0 4 12h1a2 2 0 1 0 0 4 2 2 0 0 0 0-4h7a2 2 0 1 0 0 4 2 2 0 0 0 0-4h1a.5.5 0 0 0 .491-.408l1.5-8A.5.5 0 0 0 14.5 3H2.89l-.405-1.621A.5.5 0 0 0 2 1H.5zm3.915 10L3.102 4h10.796l-1.313 7h-8.17zM6 14a1 1 0 1 1-2 0 1 1 0 0 1 2 0zm7 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"></path>
                            </svg>
                            <span id="circulo-rojo" class="circulo-rojo" style="display:none;"></span>
                        </span>
                        <span class="text">Confirmar Pedido</span>
                    </button>
                </form>
            </div>
            
            <div class="paso-navegacion">
                <button class="btn btn-secondary" id="volver-envio">Anterior</button>
            </div>
        </div>

        <!-- Paso 4: Confirmación -->
        <div id="paso-confirmacion" class="paso-checkout hidden">
            <h2>¡Pedido Confirmado!</h2>
            
            <div class="confirmacion-boleta">
                <div class="boleta-header">
                    <div class="logo-tienda">LUXE STYLE</div>
                    <div class="boleta-info">
                        <p>Boleta Electrónica</p>
                        <p>Fecha: <span id="fecha-actual"></span></p>
                        <p>Nº Pedido: <span id="numero-pedido"></span></p>
                    </div>
                </div>
                
                <div class="boleta-cliente">
                    <h3>Datos del Cliente</h3>
                    <p>Cliente: <span id="cliente-nombre">-</span></p>
                    <p>DNI: <span id="cliente-dni">-</span></p>
                    <p>Email: <span id="cliente-email">-</span></p>
                    <p>Teléfono: <span id="cliente-telefono">-</span></p>
                </div>
                
                <div class="boleta-envio">
                    <h3>Información de Envío</h3>
                    <p>Método: <span id="metodo-envio">-</span></p>
                    <p id="direccion-envio">-</p>
                </div>
                
                <div class="boleta-productos">
                    <h3>Detalle de Productos</h3>
                    <table class="tabla-productos">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Cantidad</th>
                                <th>Precio Unit.</th>
                                <th>Subtotal</th>
                            </tr>
                        </thead>
                        <tbody id="resumen-productos">
                            <!-- Aquí se agregarán los productos dinámicamente -->
                        </tbody>
                    </table>
                </div>
                
                <div class="boleta-totales">
                    <div class="linea-total">
                        <span>Subtotal:</span>
                        <span id="subtotal">S/ 0.00</span>
                    </div>
                    <div class="linea-total">
                        <span>Envío:</span>
                        <span id="costo-envio">S/ 0.00</span>
                    </div>
                    <div class="linea-total total-final">
                        <span>Total:</span>
                        <span id="total-pedido">S/ 0.00</span>
                    </div>
                </div>
                
                <div class="boleta-pago">
                    <h3>Información de Pago</h3>
                    <p>Método: <span id="metodo-pago-resumen">-</span></p>
                    <p id="detalle-pago">-</p>
                </div>
                
                <div style="margin-top: 1.5rem; text-align: right;">
                    <img src="../img/firma.png" alt="Firma" style="width:160px; margin-top:20px; display:inline-block; border-top:1px solid #bbb;">
                </div>
                
                <div class="boleta-footer">
                    <p>¡Gracias por tu compra!</p>
                    <small>Recibirás un correo electrónico con los detalles de tu pedido.</small>
                </div>
            </div>
            
            <div class="paso-navegacion mejorada">
                <button class="btn-volver-tienda" id="volver-tienda">
                    <span class="icono-btn">
                        <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M15 18l-6-6 6-6"/></svg>
                    </span>
                    Volver a la Tienda
                </button>
                <button class="btn-descargar-boleta" id="descargar-boleta">
                    <span class="icono-btn">
                        <svg width="22" height="22" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M12 5v14M5 12l7 7 7-7"/></svg>
                    </span>
                    Descargar Boleta
                </button>
            </div>
        </div>
    </div>

    <!-- Justo después de la etiqueta body o antes del cierre de body -->
    <div class="overlay" id="overlay"></div>

    <!-- Formulario oculto para agregar dirección nueva -->
    <div id="nueva-direccion-form">
        <h4>Agregar nueva dirección</h4>
        <div class="form-group">
            <label for="etiqueta-direccion">Nombre de la dirección</label>
            <input type="text" id="etiqueta-direccion" placeholder="Casa, Trabajo, etc.">
        </div>
        <div class="form-group">
            <label for="direccion-nueva">Dirección</label>
            <input type="text" id="direccion-nueva" required>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label for="ciudad-nueva">Ciudad</label>
                <input type="text" id="ciudad-nueva" required>
            </div>
            <div class="form-group">
                <label for="codigo-postal-nuevo">Código Postal</label>
                <input type="text" id="codigo-postal-nuevo" required>
            </div>
        </div>
        <div class="form-group">
            <label for="referencias">Referencias (opcional)</label>
            <textarea id="referencias" placeholder="Indicaciones adicionales..."></textarea>
        </div>
        <div class="form-buttons">
            <button type="button" class="btn btn-secondary" id="cancelar-direccion">Cancelar</button>
            <button type="button" class="btn btn-primary" id="guardar-direccion">Guardar</button>
        </div>
    </div>

    <!-- Modal de confirmación de pedido -->
    <div id="modal-confirmacion" class="modal-confirmacion">
        <div class="modal-contenido" id="modal-contenido-carga">
            <div class="loader">
                <div class="truckWrapper">
                    <div class="truckBody">
                        <!-- SVG del camión -->
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 198 93" class="trucksvg">
                            <path stroke-width="3" stroke="#282828" fill="#F83D3D" d="M135 22.5H177.264C178.295 22.5 179.22 23.133 179.594 24.0939L192.33 56.8443C192.442 57.1332 192.5 57.4404 192.5 57.7504V89C192.5 90.3807 191.381 91.5 190 91.5H135C133.619 91.5 132.5 90.3807 132.5 89V25C132.5 23.6193 133.619 22.5 135 22.5Z"></path>
                            <path stroke-width="3" stroke="#282828" fill="#7D7C7C" d="M146 33.5H181.741C182.779 33.5 183.709 34.1415 184.078 35.112L190.538 52.112C191.16 53.748 189.951 55.5 188.201 55.5H146C144.619 55.5 143.5 54.3807 143.5 53V36C143.5 34.6193 144.619 33.5 146 33.5Z"></path>
                            <path stroke-width="2" stroke="#282828" fill="#282828" d="M150 65C150 65.39 149.763 65.8656 149.127 66.2893C148.499 66.7083 147.573 67 146.5 67C145.427 67 144.501 66.7083 143.873 66.2893C143.237 65.8656 143 65.39 143 65C143 64.61 143.237 64.1344 143.873 63.7107C144.501 63.2917 145.427 63 146.5 63C147.573 63 148.499 63.2917 149.127 63.7107C149.763 64.1344 150 64.61 150 65Z"></path>
                            <rect stroke-width="2" stroke="#282828" fill="#FFFCAB" rx="1" height="7" width="5" y="63" x="187"></rect>
                            <rect stroke-width="2" stroke="#282828" fill="#282828" rx="1" height="11" width="4" y="81" x="193"></rect>
                            <rect stroke-width="3" stroke="#282828" fill="#DFDFDF" rx="2.5" height="90" width="121" y="1.5" x="6.5"></rect>
                            <rect stroke-width="2" stroke="#282828" fill="#DFDFDF" rx="2" height="4" width="6" y="84" x="1"></rect>
                        </svg>
                    </div>
                    <div class="truckTires">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 30 30" class="tiresvg">
                            <circle stroke-width="3" stroke="#282828" fill="#282828" r="13.5" cy="15" cx="15"></circle>
                            <circle fill="#DFDFDF" r="7" cy="15" cx="15"></circle>
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 30 30" class="tiresvg">
                            <circle stroke-width="3" stroke="#282828" fill="#282828" r="13.5" cy="15" cx="15"></circle>
                            <circle fill="#DFDFDF" r="7" cy="15" cx="15"></circle>
                        </svg>
                    </div>
                    <div class="road"></div>
                    <svg xml:space="preserve" viewBox="0 0 453.459 453.459" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" id="Capa_1" version="1.1" fill="#000000" class="lampPost">
                        <path d="M252.882,0c-37.781,0-68.686,29.953-70.245,67.358h-6.917v8.954c-26.109,2.163-45.463,10.011-45.463,19.366h9.993
      c-1.65,5.146-2.507,10.54-2.507,16.017c0,28.956,23.558,52.514,52.514,52.514c28.956,0,52.514-23.558,52.514-52.514
      c0-5.478-0.856-10.872-2.506-16.017h9.992c0-9.354-19.352-17.204-45.463-19.366v-8.954h-6.149C200.189,38.779,223.924,16,252.882,16
      c29.952,0,54.32,24.368,54.32,54.32c0,28.774-11.078,37.009-25.105,47.437c-17.444,12.968-37.216,27.667-37.216,78.884v113.914
      h-0.797c-5.068,0-9.174,4.108-9.174,9.177c0,2.844,1.293,5.383,3.321,7.066c-3.432,27.933-26.851,95.744-8.226,115.459v11.202h45.75
      v-11.202c18.625-19.715-4.794-87.527-8.227-115.459c2.029-1.683,3.322-4.223,3.322-7.066c0-5.068-4.107-9.177-9.176-9.177h-0.795
      V196.641c0-43.174,14.942-54.283,30.762-66.043c14.793-10.997,31.559-23.461,31.559-60.277C323.202,31.545,291.656,0,252.882,0z
      M232.77,111.694c0,23.442-19.071,42.514-42.514,42.514c-23.442,0-42.514-19.072-42.514-42.514c0-5.531,1.078-10.957,3.141-16.017
      h78.747C231.693,100.736,232.77,106.162,232.77,111.694z"></path>
                    </svg>
                </div>
            </div>
            <p class="mensaje-carga" style="margin-top: 30px;">Confirmando pedido...</p>
        </div>
        <div class="modal-contenido" id="modal-contenido-exito">
            <div class="check-animado">
                <svg viewBox="0 0 52 52"><circle class="circle" cx="26" cy="26" r="25" fill="none"/><path class="check" fill="none" d="M14 27l7 7 16-16"/></svg>
            </div>
            <div id="confeti"></div>
            <p class="mensaje-exito">¡Pedido confirmado!</p>
            <button id="btn-ir-boleta" class="btn btn-success">Aceptar</button>
        </div>
    </div>

    <script src="../js/carrito.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</body>
</html>